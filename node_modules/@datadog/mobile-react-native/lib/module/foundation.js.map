{"version":3,"sources":["foundation.tsx"],"names":["NativeModules","DdSdkConfiguration","InternalLog","SdkVerbosity","TimeProvider","bufferNativeCallReturningId","bufferNativeCallWithId","timeProvider","DdTraceWrapper","DdTrace","startSpan","operation","context","timestampMs","now","spanId","nativeTrace","log","DEBUG","finishSpan","id","DdSdk"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AAEA,SAASA,aAAT,QAA8B,cAA9B;AACA,SAASC,kBAAT,QAAgD,SAAhD;AACA,SAAQC,WAAR,QAA0B,eAA1B;AACA,SAAQC,YAAR,QAA2B,gBAA3B;AACA,SAAQC,YAAR,QAA2B,gBAA3B;AAEA,SAASC,2BAAT,EAAsCC,sBAAtC,QAAoE,+CAApE;AAEA,MAAMC,YAAY,GAAG,IAAIH,YAAJ,EAArB;;AAEA,MAAMI,cAAN,CAA4C;AAAA;AAAA,yCAECR,aAAa,CAACS,OAFf;AAAA;;AAIxCC,EAAAA,SAAS,CAACC,SAAD,EAAoBC,OAAe,GAAG,EAAtC,EAA0CC,WAAmB,GAAGN,YAAY,CAACO,GAAb,EAAhE,EAAqG;AAC1G,QAAIC,MAAM,GAAGV,2BAA2B,CAAC,MAAK,KAAKW,WAAL,CAAiBN,SAAjB,CAA2BC,SAA3B,EAAsCC,OAAtC,EAA+CC,WAA/C,CAAN,CAAxC;AACAX,IAAAA,WAAW,CAACe,GAAZ,CAAgB,oBAAqBN,SAArB,GAAiC,KAAjC,GAAyCI,MAAzD,EAAiEZ,YAAY,CAACe,KAA9E;AACA,WAAOH,MAAP;AACH;;AAEDI,EAAAA,UAAU,CAACJ,MAAD,EAAiBH,OAAe,GAAG,EAAnC,EAAuCC,WAAmB,GAAGN,YAAY,CAACO,GAAb,EAA7D,EAAgG;AACtGZ,IAAAA,WAAW,CAACe,GAAZ,CAAgB,qBAAsBF,MAAtC,EAA8CZ,YAAY,CAACe,KAA3D;AACA,WAAOZ,sBAAsB,CAAEc,EAAD,IAAS,KAAKJ,WAAL,CAAiBG,UAAjB,CAA4BC,EAA5B,EAAgCR,OAAhC,EAAyCC,WAAzC,CAAV,EAAiEE,MAAjE,CAA7B;AACH;;AAbuC;;AAgB5C,MAAMM,KAAsB,GAAGrB,aAAa,CAACqB,KAA7C;AACA,MAAMZ,OAAoB,GAAG,IAAID,cAAJ,EAA7B;AAEA,SAASP,kBAAT,EAA6BoB,KAA7B,EAAoCZ,OAApC","sourcesContent":["/*\n * Unless explicitly stated otherwise all files in this repository are licensed under the Apache License Version 2.0.\n * This product includes software developed at Datadog (https://www.datadoghq.com/).\n * Copyright 2016-Present Datadog, Inc.\n */\n\nimport { NativeModules } from 'react-native';\nimport { DdSdkConfiguration, DdTraceType } from './types';\nimport {InternalLog} from \"./InternalLog\"\nimport {SdkVerbosity} from \"./SdkVerbosity\";\nimport {TimeProvider} from \"./TimeProvider\";\nimport type { DdNativeSdkType, DdNativeTraceType } from './nativeModulesTypes';\nimport { bufferNativeCallReturningId, bufferNativeCallWithId } from './sdk/DatadogProvider/Buffer/bufferNativeCall';\n\nconst timeProvider = new TimeProvider();\n\nclass DdTraceWrapper implements DdTraceType {\n\n    private nativeTrace: DdNativeTraceType = NativeModules.DdTrace;\n\n    startSpan(operation: string, context: object = {}, timestampMs: number = timeProvider.now()): Promise<string> {\n        let spanId = bufferNativeCallReturningId(() =>this.nativeTrace.startSpan(operation, context, timestampMs));\n        InternalLog.log(\"Starting span “\" +  operation + \"” #\" + spanId, SdkVerbosity.DEBUG);\n        return spanId\n    }\n\n    finishSpan(spanId: string, context: object = {}, timestampMs: number = timeProvider.now()): Promise<void> {\n        InternalLog.log(\"Finishing span #\" +  spanId, SdkVerbosity.DEBUG);\n        return bufferNativeCallWithId((id) =>  this.nativeTrace.finishSpan(id, context, timestampMs), spanId);\n    }\n}\n\nconst DdSdk: DdNativeSdkType = NativeModules.DdSdk;\nconst DdTrace: DdTraceType = new DdTraceWrapper();\n\nexport { DdSdkConfiguration, DdSdk, DdTrace };\n"]}